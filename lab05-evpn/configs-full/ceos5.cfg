hostname ceos5
!
service routing protocols model multi-agent
!
ip routing
!
vlan 10
!
interface Loopback0
   ip address 5.5.5.5/32
!
interface Ethernet1
   no switchport
   description to-Spine1(ceos1)
   ip address 10.1.0.10/30
!
interface Ethernet2
   no switchport
   description to-Spine2(ceos2)
   ip address 10.2.0.10/30
!
interface Vxlan1
   vxlan source-interface Loopback0
   vxlan udp-port 4789
   vxlan vlan 10 vni 10010
!
router bgp 65003
   router-id 5.5.5.5
   no bgp default ipv4-unicast
   !
   ! アンダーレイ用 peer-group（P2P eBGP、IPv4 unicast）
   neighbor SPINE_UNDERLAY peer group
   neighbor SPINE_UNDERLAY send-community extended
   !
   ! オーバーレイ用 peer-group（Loopback 間 eBGP、EVPN のみ）
   neighbor SPINE_OVERLAY peer group
   neighbor SPINE_OVERLAY ebgp-multihop 3
   neighbor SPINE_OVERLAY update-source Loopback0
   neighbor SPINE_OVERLAY send-community extended
   !
   ! アンダーレイ eBGP ピア（Spine P2P リンク）
   neighbor 10.1.0.9 peer group SPINE_UNDERLAY
   neighbor 10.1.0.9 remote-as 65000
   neighbor 10.2.0.9 peer group SPINE_UNDERLAY
   neighbor 10.2.0.9 remote-as 65000
   !
   ! オーバーレイ EVPN eBGP ピア（Spine Loopback）
   neighbor 1.1.1.1 peer group SPINE_OVERLAY
   neighbor 1.1.1.1 remote-as 65000
   neighbor 2.2.2.2 peer group SPINE_OVERLAY
   neighbor 2.2.2.2 remote-as 65000
   !
   ! VLAN 10 の EVPN 設定（MAC-IP Type2 ルートを広告）
   vlan 10
      rd 5.5.5.5:10010
      route-target import 65001:10010
      route-target export 65001:10010
      redistribute learned
   !
   address-family ipv4
      neighbor SPINE_UNDERLAY activate
      network 5.5.5.5/32
   !
   address-family evpn
      neighbor SPINE_OVERLAY activate
!
username admin privilege 15 role network-admin secret 0 admin
!
management api http-commands
   protocol http
   no shutdown
!
