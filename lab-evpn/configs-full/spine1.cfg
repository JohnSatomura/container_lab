hostname spine1
!
service routing protocols model multi-agent
!
ip routing
!
interface Loopback0
   ip address 1.1.1.1/32
!
interface Ethernet1
   no switchport
   description to-Leaf1(leaf1)
   ip address 10.1.0.1/30
!
interface Ethernet2
   no switchport
   description to-Leaf2(leaf2)
   ip address 10.1.0.5/30
!
interface Ethernet3
   no switchport
   description to-Leaf3(leaf3)
   ip address 10.1.0.9/30
!
interface Ethernet4
   no switchport
   description to-Leaf4(leaf4)
   ip address 10.1.0.13/30
!
router bgp 65000
   router-id 1.1.1.1
   no bgp default ipv4-unicast
   !
   ! アンダーレイ用 peer-group（P2P eBGP、IPv4 unicast でロopback を広告）
   neighbor LEAF_UNDERLAY peer group
   neighbor LEAF_UNDERLAY send-community extended
   !
   ! オーバーレイ用 peer-group（Loopback 間 eBGP、EVPN のみ）
   neighbor LEAF_OVERLAY peer group
   neighbor LEAF_OVERLAY ebgp-multihop 3
   neighbor LEAF_OVERLAY update-source Loopback0
   neighbor LEAF_OVERLAY send-community extended
   neighbor LEAF_OVERLAY next-hop-unchanged
   !
   ! アンダーレイ eBGP ピア
   neighbor 10.1.0.2 peer group LEAF_UNDERLAY
   neighbor 10.1.0.2 remote-as 65001
   neighbor 10.1.0.6 peer group LEAF_UNDERLAY
   neighbor 10.1.0.6 remote-as 65002
   neighbor 10.1.0.10 peer group LEAF_UNDERLAY
   neighbor 10.1.0.10 remote-as 65003
   neighbor 10.1.0.14 peer group LEAF_UNDERLAY
   neighbor 10.1.0.14 remote-as 65004
   !
   ! オーバーレイ EVPN eBGP ピア（Loopback0 アドレスで peer）
   neighbor 3.3.3.3 peer group LEAF_OVERLAY
   neighbor 3.3.3.3 remote-as 65001
   neighbor 4.4.4.4 peer group LEAF_OVERLAY
   neighbor 4.4.4.4 remote-as 65002
   neighbor 5.5.5.5 peer group LEAF_OVERLAY
   neighbor 5.5.5.5 remote-as 65003
   neighbor 6.6.6.6 peer group LEAF_OVERLAY
   neighbor 6.6.6.6 remote-as 65004
   !
   address-family ipv4
      neighbor LEAF_UNDERLAY activate
      network 1.1.1.1/32
   !
   address-family evpn
      neighbor LEAF_OVERLAY activate
!
username admin privilege 15 role network-admin secret 0 admin
!
management api http-commands
   protocol http
   no shutdown
!
